<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Drunk - Punk</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; background: linear-gradient(135deg, #fef6fa 0%, #e1fcff 100%); margin: 0; padding: 0; text-align: center;}
    .nav-bar { position: fixed; top: 0; left: 0; width: 100vw; background: #2196f3; color: white; display: flex; justify-content: flex-end; gap: 2px; z-index: 1000; box-shadow: 0 2px 8px #0002; padding: 7px 0; }
    .nav-link { color: white; padding: 7px 24px; text-decoration: none; font-weight: bold; font-size: 1.07em; border-radius: 0 0 10px 10px; transition: background 0.18s; display: flex; align-items: center; gap: 6px; }
    .nav-link.active, .nav-link:hover { background: #1760a3; }
    body { padding-top: 48px; }
    .zpet-link { display: inline-block; margin: 20px 0 4px 0; color: #1760a3; background: #e9f6fd; padding: 7px 17px; border-radius: 9px; text-decoration: none; font-weight: bold; font-size: 1.08em; box-shadow: 0 1px 8px #bbe8fd44; transition: background 0.13s, color 0.13s; }
    .zpet-link:hover { background: #b7e0ed; color: #124061; }
    h2 { margin: 16px 0 7px 0; color: #208278; font-size: 2.35em;}
    #balances { text-align:center; margin: 10px 0; font-weight: bold; font-size: 1.2em;}
    .shop-section { background: #fff; border-radius: 15px; box-shadow: 0 2px 14px #b7d9db35; display: inline-block; margin: 18px auto 0 auto; padding: 18px 28px 18px 28px; min-width: 220px; max-width: 98vw; text-align: left; }
    .shop-item { margin-bottom: 24px; }
    .item-title { font-weight: bold; font-size: 1.22em; color: #217c5e; margin-bottom: 2px; display: flex; align-items: center; gap: 11px;}
    .item-desc { color: #555; font-size: 1em; margin-bottom: 5px;}
    .item-btn { background: #37af7b; color: #fff; border: none; border-radius: 7px; font-size: 1.05em; padding: 7px 22px; cursor: pointer; font-weight: 600; margin-top: 3px;}
    .item-btn:disabled { background: #9dbdae; cursor: not-allowed;}
    .item-btn:hover:not(:disabled) { background: #136652; }
    .pronajato { color:#e26e08; font-size: 1.08em; margin-left: 8px;}
    #shop-status { color:#b24b4b; font-weight:600; margin:14px auto 0 auto; display:block;}
    #shop-status.ok { color:#217c5e; }
    #chytani { margin:28px auto 0 auto; }
    #chytitBtn { background: #22c984; color: #fff; border: none; border-radius: 11px; box-shadow: 0 2px 12px #44a66a25; font-weight: 900; letter-spacing: 1px; font-size:1.12em; padding: 14px 40px; cursor:pointer; transition: background 0.14s, box-shadow 0.14s; margin-bottom:10px;}
    #chytitBtn:active { background: #139259; }
    .result-box { margin:30px auto 12px auto; min-height:56px; background:#e6fff3; border-radius:15px; box-shadow:0 2px 12px #7fffd455; font-size:1.22em; color:#136652; font-weight:700; display:inline-block; padding:15px 38px 13px 38px;}
    /* --- Fishing slots --- */
    #fishing-slots { display: flex; justify-content: center; gap: 26px; margin:36px auto 10px auto; flex-wrap:wrap;}
    .slot { background:#f6fdff; border-radius:13px; box-shadow:0 2px 12px #b6eafc38; padding:19px 22px 16px 22px; min-width:220px; max-width:99vw; margin-bottom:12px; }
    .slot-title { font-weight: bold; font-size:1.19em; color:#1c6375; margin-bottom: 10px; }
    .slot-status { margin:7px 0 11px 0; color:#217c5e; min-height:36px;}
    .progress-bar-bg { width:100%; background:#dbf3ff; border-radius: 8px; height:21px; margin-bottom:6px; overflow:hidden; border:1px solid #b6eafc;}
    .progress-bar-fill { background:#22c984; height:100%; transition:width 0.25s; }
    .slot-btn { background: #2a87c3; color: #fff; border:none; border-radius:7px; font-weight:600; font-size:1.04em; padding:7px 23px; cursor:pointer; margin:0 2px;}
    .slot-btn:disabled { background: #b8d8eb; cursor:not-allowed;}
    .slot-btn-boost { background: #e0b315; color: #422d00;}
    .slot-btn-boost:disabled { background: #f6eab7;}
    .collect-btn { background: #23c96e; color: #fff; font-size:1.09em; font-weight:700; border:none; border-radius:8px; padding:10px 34px; cursor:pointer; margin:5px 0 0 0;}
    .collect-btn:disabled { background:#b8d8cb;}
    .result-box-slot { margin:16px auto 7px auto; min-height:38px; background:#e6fff3; border-radius:10px; box-shadow:0 2px 8px #7fffd455; font-size:1.1em; color:#136652; font-weight:700; display:inline-block; padding:9px 18px 8px 18px;}
    @media (max-width:900px){ #fishing-slots{gap:10px;} .slot{padding:10px 5px;} }
    @media (max-width:600px){ body { padding-top: 90px; } .nav-bar { justify-content: center; flex-wrap: wrap; font-size: 0.97em; } .nav-link { padding:7px 8px;font-size:1em; } .zpet-link { padding: 7px 6vw; font-size:1em;} h2 { font-size: 2.1em; } .shop-section { padding:12px; } #chytitBtn { font-size:1em; padding:12px 8vw;} #fishing-slots{gap:6px;} }
  </style>
</head>
<body>
  <div class="nav-bar">
    <a href="pestovani.html" class="nav-link">üå± Grow Sh*t</a>
    <a href="vyroba.html" class="nav-link">‚öóÔ∏è Brewing</a>
    <a href="jzd.html" class="nav-link">üê∑ Coop</a>
    <a href="sklad.html" class="nav-link">üì¶ Stash</a>
    <a href="hotel.html" class="nav-link">üè® Motel</a>
    <a href="pub.html" class="nav-link">üè° Bar</a>
    <a href="market.html" class="nav-link">üè™ Bazaar</a>
    <a href="finance.html" class="nav-link">üí∞ Wallet</a>
    <a class="nav-link nav-link-stats" href="statistiky.html">üìä</a>
  </div>
  <a href="vyroba.html" class="zpet-link">‚Üê Back to production</a>
  <h2>üé£ Fishing</h2>
   <div id="balances" style="text-align:center; margin: 10px 0; font-weight: bold; font-size: 1.2em;">
 <b>üíµ Balance: <span id="money"></span> $<br> 
  ü™ô PI Coins: <span id="pi-balance"></span></b> œñ
   </div>
  <div class="shop-section">
  <div style="font-size:1.07em;font-weight:bold;color:#207c7c;margin-bottom:10px;">Regular gear</div>
  <div class="shop-item">
    <div class="item-title">üé£ Fishing Rod ($)
      <span id="prutStatus" class="pronajato"></span>
    </div>
    <div class="item-desc">Rent a regular fishing rod. After each attempt, you have to rent it again.<br><b>Price: 50 $</b></div>
    <button class="item-btn" id="buyPrutBtn" onclick="pronajmoutPrut()">Rent rod</button>
  </div>
  <div class="shop-item">
    <div class="item-title">ü™± Bait ($)
      <span id="navnadaStatus" class="pronajato"></span>
    </div>
    <div class="item-desc">No bait, no catch! You need a new one for every attempt.<br><b>Price: 20 $</b></div>
    <button class="item-btn" id="buyNavnadaBtn" onclick="pronajmoutNavnadu()">Buy bait</button>
  </div>
  <hr style="margin:18px 0 12px 0;border:0;border-top:2px dashed #c8c8fa;">
  <div style="font-size:1.07em;font-weight:bold;color:#b17316;margin-bottom:10px;">Premium gear (œñ only)</div>
  <div class="shop-item" style="background:#fffbea;">
    <div class="item-title">üé£ Fishing Rod (œñ)
      <span id="prutPiStatus" class="pronajato"></span>
      <span style="background:#ffe396;color:#ad8700;padding:2px 10px;border-radius:7px;font-size:0.92em;margin-left:7px;">œñ EXCLUSIVE</span>
    </div>
    <div class="item-desc">Premium fishing rod.<br>Better loot, chance for Pi or $!<br><b>Price: 20 œñ</b></div>
    <button class="item-btn" id="buyPrutPiBtn" onclick="pronajmoutPrutPi()">Rent rod (œñ)</button>
  </div>
  <div class="shop-item" style="background:#fffbea;">
    <div class="item-title">ü™± Bait (œñ)
      <span id="navnadaPiStatus" class="pronajato"></span>
      <span style="background:#ffe396;color:#ad8700;padding:2px 10px;border-radius:7px;font-size:0.92em;margin-left:7px;">œñ EXCLUSIVE</span>
    </div>
    <div class="item-desc">Premium bait. Can be used with any rod.<br><b>Price: 5 œñ</b></div>
    <button class="item-btn" id="buyNavnadaPiBtn" onclick="pronajmoutNavnadaPi()">Buy bait (œñ)</button>
  </div>
  <span id="shop-status"></span>
</div>

  <!-- --- SLOTS --- -->
  <div id="fishing-slots"></div>
  <!-- ... (v≈°echny tv√© styly atd. z≈Øst√°vaj√≠, zaƒç√≠n√°me od JS a shopu) ... -->
<script>
  var fishingItems = [
    { key:"shrimp", label: "Shrimp", emoji:"ü¶ê" },
    { key:"crab", label: "Crab", emoji:"ü¶Ä" },
    { key:"fish", label: "Fish", emoji:"üê†" },
    { key:"octopus", label: "Octopus", emoji:"üêô" },
    { key:"tempura", label: "Tempura", emoji:"üç§" },
    { key:"poop", label: "Poop", emoji:"üí©" },
    { key:"boot", label: "Boot", emoji:"üë¢" }
  ];

  function getPi() { return JSON.parse(localStorage.getItem("lihobaronPi") || "0"); }
  function renderPiBalance() { document.getElementById("pi-balance").textContent = getPi(); }
  function load(key, def) { try { let d=localStorage.getItem(key); if(!d)return def; return JSON.parse(d);}catch{return def;} }
  function save(key, val) { localStorage.setItem(key, JSON.stringify(val)); }
  function getMoney() { return load("lihobaronFarmCoins", 0);}
  function setMoney(m) { save("lihobaronFarmCoins", m);}
  function setPi(m) { localStorage.setItem("lihobaronPi", JSON.stringify(m)); }
  function stavPrachy() { document.getElementById("money").innerText = getMoney(); }

  // POƒå√çTADLA
  function getInvPrut() { return load("fishPrutAmount",0); }
  function getInvPrutPi() { return load("fishPrutPiAmount",0);}
  function getInvNavnada() { return load("fishNavnadaAmount",0);}
  function getInvNavnadaPi() { return load("fishNavnadaPiAmount",0);}
  function setInvPrut(n) { save("fishPrutAmount", n);}
  function setInvPrutPi(n) { save("fishPrutPiAmount", n);}
  function setInvNavnada(n) { save("fishNavnadaAmount", n);}
  function setInvNavnadaPi(n) { save("fishNavnadaPiAmount", n);}
  function updateShopStatus() {
    document.getElementById("prutStatus").textContent = getInvPrut()>0 ? "‚Ä¢ " + getInvPrut() + " owned" : "";
    document.getElementById("prutPiStatus").textContent = getInvPrutPi()>0 ? "‚Ä¢ " + getInvPrutPi() + " owned" : "";
    document.getElementById("navnadaStatus").textContent = getInvNavnada()>0 ? "‚Ä¢ " + getInvNavnada() + " owned" : "";
    document.getElementById("navnadaPiStatus").textContent = getInvNavnadaPi()>0 ? "‚Ä¢ " + getInvNavnadaPi() + " owned" : "";
  }

  function pronajmoutPrut() {
    let money = getMoney();
    if (money < 50) { shopStatus("Not enough $ for rod!"); return; }
    setMoney(money - 50);
    setInvPrut(getInvPrut()+1);
    stavPrachy(); updateShopStatus(); shopStatus("Rod bought!", true);
  }
  function pronajmoutPrutPi() {
    let pi = getPi();
    if (pi < 20) { shopStatus("Not enough œñ for rod!"); return; }
    setPi(pi - 20);
    setInvPrutPi(getInvPrutPi()+1);
    renderPiBalance(); updateShopStatus(); shopStatus("œñ rod bought!", true);
  }
  function pronajmoutNavnadu() {
    let money = getMoney();
    if (money < 20) { shopStatus("Not enough $ for bait!"); return; }
    setMoney(money - 20);
    setInvNavnada(getInvNavnada()+1);
    stavPrachy(); updateShopStatus(); shopStatus("Bait bought!", true);
  }
  function pronajmoutNavnadaPi() {
    let pi = getPi();
    if (pi < 5) { shopStatus("Not enough œñ for bait!"); return; }
    setPi(pi - 5);
    setInvNavnadaPi(getInvNavnadaPi()+1);
    renderPiBalance(); updateShopStatus(); shopStatus("œñ bait bought!", true);
  }
  function shopStatus(txt, ok) {
    let el = document.getElementById("shop-status");
    el.textContent = txt;
    el.className = ok ? "ok" : "";
    setTimeout(function(){ el.textContent=""; },1800);
  }

  // ---- 3 sloty, u≈æ jen vezmou kusy z inventory ----
  const FISHING_SLOT_COUNT = 3;
  const FISHING_TIME = 60;
  const FISHING_BOOST_COST = 10;
  var slots = [];
  for(let i=0;i<FISHING_SLOT_COUNT;i++) {
    slots.push({
      state: "idle", // idle, waiting, ready
      startTime: 0,
      duration: FISHING_TIME,
      boosted: false,
      result: null,
      prut: null,
      navnada: null,
    });
  }

  function renderFishingSlots() {
    let html = "";
    for(let i=0;i<slots.length;i++) {
      let slot = slots[i];
      html += "<div class='slot' id='slot"+i+"'>";
      html += "<div class='slot-title'>üé£ Fish Slot "+(i+1)+"</div>";
      if(slot.state === "idle") {
        html += "<div class='slot-status'>Ready to fish!</div>";
        html += "<button class='slot-btn' onclick='startFishingSlot("+i+")'>Fish!</button>";
      } else if(slot.state === "waiting") {
        let elapsed = Math.max(0, Math.floor((Date.now()-slot.startTime)/1000));
        let perc = Math.min(100, Math.floor(elapsed/slot.duration*100));
        html += "<div class='slot-status'>Fishing... ("+(slot.boosted?"boosted ":"")+(slot.duration-elapsed)+"s left)</div>";
        html += "<div class='progress-bar-bg'><div class='progress-bar-fill' style='width:"+perc+"%'></div></div>";
        if(!slot.boosted)
          html += "<button class='slot-btn slot-btn-boost' onclick='boostFishingSlot("+i+")'>Speed up (-10 œñ)</button>";
      } else if(slot.state === "ready") {
        html += "<div class='slot-status'>üéâ Result ready!</div>";
        if(slot.result)
          html += "<div class='result-box-slot'>"+slot.result.text+"</div>";
        html += "<button class='collect-btn' onclick='collectFishingSlot("+i+")'>Collect!</button>";
      }
      html += "</div>";
    }
    document.getElementById("fishing-slots").innerHTML = html;
  }

  function startFishingSlot(slotIdx) {
    let slot = slots[slotIdx];
    if(slot.state !== "idle") return;
    // --- vezme≈° Pi pokud m√°≈°, jinak $ ---
    let prut = getInvPrutPi()>0 ? "pi" : (getInvPrut()>0 ? "$" : null);
    let navnada = getInvNavnadaPi()>0 ? "pi" : (getInvNavnada()>0 ? "$" : null);

    if(!prut || !navnada) {
      alert("You need a rod and a bait for this slot!");
      return;
    }

    // ODEBER pou≈æit√© pruty/navnady (spot≈ôebuj)
    if(prut==="pi") setInvPrutPi(getInvPrutPi()-1);
    if(prut==="$") setInvPrut(getInvPrut()-1);
    if(navnada==="pi") setInvNavnadaPi(getInvNavnadaPi()-1);
    if(navnada==="$") setInvNavnada(getInvNavnada()-1);
    updateShopStatus();

    slot.state = "waiting";
    slot.startTime = Date.now();
    slot.duration = FISHING_TIME;
    slot.boosted = false;
    slot.result = null;
    slot.prut = prut;
    slot.navnada = navnada;
    renderFishingSlots();
    tickFishingSlot(slotIdx);
  }

  function boostFishingSlot(slotIdx) {
    let slot = slots[slotIdx];
    if(slot.state!=="waiting" || slot.boosted) return;
    let pi = getPi();
    if(pi<FISHING_BOOST_COST) {
      alert("Not enough œñ to speed up!");
      return;
    }
    setPi(pi-FISHING_BOOST_COST);
    slot.duration = Math.ceil(slot.duration/2);
    slot.boosted = true;
    renderPiBalance();
    renderFishingSlots();
  }

  function tickFishingSlot(idx) {
    let slot = slots[idx];
    if(slot.state!=="waiting") return;
    let elapsed = Math.max(0, Math.floor((Date.now()-slot.startTime)/1000));
    if(elapsed >= slot.duration) {
      slot.state = "ready";
      slot.result = { text: getFishingSlotResultText(slot.prut, slot.navnada) };
      renderFishingSlots();
    } else {
      renderFishingSlots();
      setTimeout(function(){ tickFishingSlot(idx); }, 900);
    }
  }

  function collectFishingSlot(idx) {
    let slot = slots[idx];
    slot.state = "idle";
    slot.startTime = 0;
    slot.result = null;
    slot.duration = FISHING_TIME;
    slot.boosted = false;
    slot.prut = null;
    slot.navnada = null;
    renderFishingSlots();
  }

  function getFishingSlotResultText(prut, navnada) {
    // $ prut + $ n√°vnada
    if(prut==="$" && navnada==="$") {
      let roll = Math.random();
      if(roll<0.35)  return "üí© You caught <b>Poop</b>! Just your luck...";
      if(roll<0.70)  return "üë¢ You caught a <b>Boot</b>! At least it's vintage?";
      if(roll<0.90)  { addToStorage("fish"); return "üê† You caught a <b>Fish</b>!"; }
      if(roll<0.925) { addToStorage("shrimp"); return "ü¶ê You caught a <b>Shrimp</b>!"; }
      if(roll<0.95)  { addToStorage("crab"); return "ü¶Ä You caught a <b>Crab</b>!"; }
      if(roll<0.975) { addToStorage("octopus"); return "üêô You caught an <b>Octopus</b>!"; }
      addToStorage("tempura"); return "üç§ You caught <b>Tempura</b>! Fried but fresh.";
    }
    // Pi prut + Pi n√°vnada
    if(prut==="pi" && navnada==="pi") {
      let roll = Math.random();
      if(roll < 0.20) { addToStorage("fish"); return "üê† You caught a <b>Fish</b>!"; }
      if(roll < 0.30) { addToStorage("shrimp"); return "ü¶ê You caught a <b>Shrimp</b>!"; }
      if(roll < 0.40) { addToStorage("crab"); return "ü¶Ä You caught a <b>Crab</b>!"; }
      if(roll < 0.50) { addToStorage("octopus"); return "üêô You caught an <b>Octopus</b>!"; }
      if(roll < 0.60) { addToStorage("tempura"); return "üç§ You caught <b>Tempura</b>! Fancy!"; }
      if(roll < 0.75) { setMoney(getMoney()+200); stavPrachy(); return "üí∏ +$200 cash!"; }
      if(roll < 0.85) { setPi(getPi()+50); renderPiBalance(); return "üî• JACKPOT! +50 œñ!"; }
      if(roll < 0.90) { setInvPrut(getInvPrut()+1); updateShopStatus(); return "üé£ You fished up a regular rod!"; }
      if(roll < 0.95) { setInvNavnada(getInvNavnada()+1); updateShopStatus(); return "ü™± You fished up a regular bait!"; }
      if(roll < 0.975) { setInvPrutPi(getInvPrutPi()+1); updateShopStatus(); return "üé£ You fished up a œñ rod!"; }
      setInvNavnadaPi(getInvNavnadaPi()+1); updateShopStatus(); return "ü™± You fished up a œñ bait!";
    }
    // Mixovan√© kombinace (pi + $, $ + pi): Ryby, tempura, ale m≈Ø≈æe padnout i bota/hovno
    if((prut==="pi" && navnada==="$") || (prut==="$" && navnada==="pi")) {
      let roll = Math.random();
      if(roll<0.2)  return "üí© You caught <b>Poop</b>! Well, almost lunch.";
      if(roll<0.35)  return "üë¢ You caught a <b>Boot</b>!";
      if(roll<0.65)  { addToStorage("fish"); return "üê† You caught a <b>Fish</b>!"; }
      if(roll<0.75)  { addToStorage("shrimp"); return "ü¶ê You caught a <b>Shrimp</b>!"; }
      if(roll<0.83)  { addToStorage("crab"); return "ü¶Ä You caught a <b>Crab</b>!"; }
      if(roll<0.91)  { addToStorage("octopus"); return "üêô You caught an <b>Octopus</b>!"; }
      addToStorage("tempura"); return "üç§ You caught <b>Tempura</b>! Not bad!";
    }
    // Fallback
    return "‚ùì Something glitched. Let Vo≈àkys know!";
  }

  function addToStorage(itemKey) {
    let storage = load("lihobaronFarmStorage", {});
    storage[itemKey] = (storage[itemKey]||0)+1;
    save("lihobaronFarmStorage", storage);
  }

  window.onload = function() {
    stavPrachy();
    renderPiBalance();
    updateShopStatus();
    renderFishingSlots();
  };

  var lastResult = "";
  function renderChytani() {
    document.getElementById("chytani").innerHTML = "";
  }
</script>
</body>
</html>
