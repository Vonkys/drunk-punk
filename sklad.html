<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>Drunk - Punk</title>
   <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
 <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; background: #f8f8fa; margin: 0; padding: 0;}
   h1 { text-align: center; color: #208278; margin-top: 70px;}
@media (max-width: 600px) {
  h1 { margin-top: 30px;} /* nebo klidnÄ› 20px, uprav si podle oka */
  }
    .nav-bar { position: fixed; top: 0; left: 0; width: 100vw; background: #2196f3; color: white;
      display: flex; justify-content: flex-end; gap: 2px; z-index: 1000; box-shadow: 0 2px 8px #0002; padding: 7px 0; }
    .nav-link { color: white; padding: 7px 24px; text-decoration: none; font-weight: bold; font-size: 1.07em;
      border-radius: 0 0 10px 10px; transition: background 0.18s; display: flex; align-items: center; gap: 6px; }
    .nav-link.active, .nav-link:hover { background: #1760a3; }
    .sekce { background: #fff; border-radius: 14px; box-shadow: 0 2px 16px #b7d9db35; margin: 20px auto 0 auto; padding: 18px 16px 15px 16px; max-width: 430px;}
    .nav-link-stats {
      background: #e26e08 !important;  /* zlatÃ¡, nebo tÅ™eba #ff66a3, #a0e370, prostÄ› nÄ›co co nikde jinde nenÃ­ */
      color: #333 !important;
      border-radius: 11px;
      margin-left: 6px;
     font-size: 1.32em;  /* vÄ›tÅ¡Ã­ emoji, aÅ¥ to svÃ­tÃ­ */
     box-shadow: 0 2px 10px #ffd70033;
     border: 2.5px solid #fff;
     filter: saturate(1.4) brightness(1.12); 
    }
    .sekce h2 {margin-top:0;}
    .list {margin:8px 0;}
    .polozka {padding: 5px 0 5px 0; font-size: 1.08em; border-bottom: 1px solid #eee; display:flex;align-items:center;}
    .ikona {font-size: 1.22em; margin-right:7px;}
    .none {color:#aaa;}
   @media (max-width:600px){
  .container{padding:10px;}
  .nav-link{padding:7px 8px;font-size:1em;}
   .nav-bar{flex-wrap:wrap; justify-content:center;}  /* TADY! */
  body { padding-top: 90px; }
}
.back-disketa {
  position: fixed;
  top: 65px; /* nebo 60px podle pÅ™esnÃ© vÃ½Å¡ky navigace! */
  left: 10px;
  font-size: 2em;
  background: #22c55e;
  border: none;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  cursor: pointer;
  padding: 0.08em 0.42em 0.13em 0.42em;
  z-index: 2002;
  transition: background 0.18s;
  line-height: 1.1em;
}

.back-disketa:hover {
  background: #16a34a;
}
@media (max-width:600px) {
  .back-disketa {
    top: 95px; /* pokud mÃ¡ navigace na mobilu vÄ›tÅ¡Ã­ vÃ½Å¡ku */
    left: 10px;
    font-size: 1.6em;
    padding: 0.02em 0.33em 0.13em 0.33em;
  }
}
  </style>
</head>
<body>
  <div class="nav-bar">
    <a href="pestovani.html" class="nav-link">ğŸŒ± Grow Sh*t</a>
<a href="vyroba.html" class="nav-link">âš—ï¸ Brewing</a>
<a href="jzd.html" class="nav-link">ğŸ· Coop</a>
<a href="sklad.html" class="nav-link active">ğŸ“¦ Stash</a>
<a href="hotel.html" class="nav-link">ğŸ¨ Motel</a>
<a href="pub.html" class="nav-link">ğŸ¡ Bar</a>
<a href="market.html" class="nav-link">ğŸª Bazaar</a>
<a href="finance.html" class="nav-link">ğŸ’° Wallet</a>
<a class="nav-link nav-link-stats" href="statistiky.html">ğŸ“Š</a>   
</div>

<h1>ğŸ“¦ Stash</h1>
<div id="msg" style="color:#1760a3; margin:14px 0 0 0; font-weight:bold; font-size:1.13em; text-align:center; width:100%; display:block;"></div>
   <div class="sekce">
    <h2>ğŸŒ¾ Crops & Fruit</h2>
    <div id="suroviny" class="list"></div>
  </div>
  <div class="sekce">
    <h2>ğŸŒ± Seeds</h2>
    <div id="semena" class="list"></div>
  </div>
  <div class="sekce">
    <h2>ğŸ® Animals</h2>
    <div id="zvirata" class="list"></div>
  </div>
  <div class="sekce">
    <h2>ğŸ”§ Machines</h2>
    <div id="stroje" class="list"></div>
  </div>
  <div class="sekce">
    <h2>ğŸº Ferments & Products</h2>
    <div id="vyrobky" class="list"></div>
  </div>

<script>
if (!localStorage.getItem("lihobaronFarmStorage")) {
  localStorage.setItem("lihobaronFarmStorage", JSON.stringify({
    pÅ¡enice: 0, ryze: 0, chmel: 0, kukuÅ™ice: 0, reva: 0, jablko: 0, hruÅ¡ky: 0, Å¡vestky: 0,
    meruÅˆky: 0, broskve: 0, mrkev: 0, brambora: 0, rajÄata: 0, chilli: 0, trtina: 0,
    okurky: 0, tÅ™eÅ¡nÄ›: 0, cibule: 0, Äesnek: 0, jahody: 0, vejce: 0, krÅ¯tÃ­_maso: 0, Å¡unka: 0, mlÃ©ko: 0, kozÃ­_mlÃ©ko: 0, testo: 0, bread: 0, water: 0, curd: 0,
    goat_cheese: 0, bacon: 0, fried_egg: 0, turkey_hamburger: 0, nudle: 0,
  }));
}
if (!localStorage.getItem("lihobaronFarmSeeds")) {
  localStorage.setItem("lihobaronFarmSeeds", JSON.stringify({
    pÅ¡enice: 0, ryze: 0, chmel: 0, kukuÅ™ice: 0, reva: 0, jablko: 0, hruÅ¡ka: 0, Å¡vestka: 0,
    meruÅˆka: 0, broskev: 0, mrkev: 0, brambora: 0, rajÄata: 0, chilli: 0, trtina: 0,
    okurky: 0, tÅ™eÅ¡nÄ›: 0, cibule: 0, Äesnek: 0, jahody: 0
  }));
}
if (!localStorage.getItem("lihobaronFarmXP")) {
  localStorage.setItem("lihobaronFarmXP", 0);
}
if (!localStorage.getItem("lihobaronFarmCoins")) {
  localStorage.setItem("lihobaronFarmCoins", 200);
}

// ZVÃÅ˜ATA A PRODUKTY
const animalList = {
  krava:     { nazev: "Cow", emoji: "ğŸ®" },
  slepice:   { nazev: "Hen", emoji: "ğŸ”" },
  prase:     { nazev: "Pig", emoji: "ğŸ·" },
  koza:      { nazev: "Goat", emoji: "ğŸ" },
  krocan:    { nazev: "Turkey", emoji: "ğŸ¦ƒ" },
  ovce:      { nazev: "Sheep", emoji: "ğŸ‘" },
  kachna:    { nazev: "Duck", emoji: "ğŸ¦†" },
  krÃ¡lÃ­k:    { nazev: "Rabbit", emoji: "ğŸ‡" },
  vcela:     { nazev: "Bee", emoji: "ğŸ" },
  };
const animalProducts = {
  mlÃ©ko:        { nazev: "Milk", emoji: "ğŸ¥›" },
  kozÃ­_mlÃ©ko:   { nazev: "Goat milk", emoji: "ğŸ¥›" },
  vejce:        { nazev: "Egg", emoji: "ğŸ¥š" },
  Å¡unka:        { nazev: "Ham", emoji: "ğŸ–" },
  krÅ¯tÃ­_maso:   { nazev: "Turkey meat", emoji: "ğŸ—" },
  med: { nazev: "Honey", emoji: "ğŸ¯" },
  vlna: { nazev: "Wool", emoji: "ğŸ§¶" },
  krÃ¡liÄÃ­_maso: { nazev: "Rabbit meat", emoji: "ğŸ¥©" },
  kachnÃ­_vejce: { nazev: "Duck egg", emoji: "ğŸ¥š" },

};
// Suroviny pro hornÃ­ box
const surovinyList = {
  pÅ¡enice: { nazev: "Wheat", emoji: "ğŸŒ¾" }, chmel:   { nazev: "Hops", emoji: "ğŸƒ" }, kukuÅ™ice: { nazev: "Corn", emoji: "ğŸŒ½" },
  ryze: { nazev: "Rice", emoji: "ğŸš" }, trtina: { nazev: "Sugar Cane", emoji: "ğŸ‹" },
  reva:    { nazev: "Grapes", emoji: "ğŸ‡" }, jablko:  { nazev: "Apple", emoji: "ğŸ" }, hruÅ¡ky:  { nazev: "Pears", emoji: "ğŸ" },
  Å¡vestky: { nazev: "Plums", emoji: "ğŸŸ£" }, meruÅˆky: { nazev: "Apricots", emoji: "ğŸ‘" }, broskve: { nazev: "Peaches", emoji: "ğŸŠ" },
  mrkev:   { nazev: "Carrot", emoji: "ğŸ¥•" }, brambora: { nazev: "Potatoes", emoji: "ğŸ¥”" }, rajÄata: { nazev: "Tomatoes", emoji: "ğŸ…" },
  chilli:  { nazev: "Chilli", emoji: "ğŸŒ¶" }, okurky:  { nazev: "Cucumbers", emoji: "ğŸ¥’" }, tÅ™eÅ¡nÄ›:    { nazev: "Cherries", emoji: "ğŸ’" },
  cibule:  { nazev: "Onion", emoji: "ğŸ§…" }, Äesnek:  { nazev: "Garlic", emoji: "ğŸ§„" }, jahody:  { nazev: "Strawberries", emoji: "ğŸ“" }
};
const semenaList = {
  pÅ¡enice: { nazev: "Wheat seed", emoji: "ğŸŒ¾" }, chmel:   { nazev: "Hops seed", emoji: "ğŸƒ" }, kukuÅ™ice: { nazev: "Corn seed", emoji: "ğŸŒ½" },
  ryze: { nazev: "Rice seed", emoji: "ğŸš" }, trtina: { nazev: "Sugar Cane Seed", emoji: "ğŸ‹" },
  reva:    { nazev: "Grape seed", emoji: "ğŸ‡" }, jablko:  { nazev: "Apple seed", emoji: "ğŸ" }, hruÅ¡ka:  { nazev: "Pear seed", emoji: "ğŸ" },
  Å¡vestka: { nazev: "Plum seed", emoji: "ğŸŸ£" }, meruÅˆka: { nazev: "Apricot seed", emoji: "ğŸ‘" }, broskev: { nazev: "Peach seed", emoji: "ğŸŠ" },
  mrkev:     { nazev: "Carrot seed", emoji: "ğŸ¥•" }, brambora:  { nazev: "Potato seed", emoji: "ğŸ¥”" }, rajÄata:   { nazev: "Tomato seed", emoji: "ğŸ…" },
  chilli:    { nazev: "Chilli seed", emoji: "ğŸŒ¶" }, okurky:    { nazev: "Cucumber seed", emoji: "ğŸ¥’" }, tÅ™eÅ¡nÄ›:      { nazev: "Cherry seed", emoji: "ğŸ’" },
  cibule:    { nazev: "Onion seed", emoji: "ğŸ§…" }, Äesnek:    { nazev: "Garlic seed", emoji: "ğŸ§„" }, jahody:    { nazev: "Strawberry seed", emoji: "ğŸ“" }
};
const strojeList = {
  kad_pivo: "Beer vat ğŸº", kotel_pivo: "Beer boiler âš±ï¸", lis_vino: "Wine press ğŸ‡", stroj_popkorn: "Popcorn machine ğŸ¿", fritak:  "Fryer ğŸŸ", 
  kad_vino: "Wine vat ğŸ·", kad_palenka: "Wine vat ğŸ¥ƒ", palenice: "Distillation setup ğŸ”¥", hrnec_marmelada: "Jam pot ğŸ¯", water_tap: "Water tap ğŸš°",
  oven: "Oven ğŸ", grill: "Grill ğŸ”¥", electric_frying_pan: "Electric Frying Pan ğŸ³", curd_machine: "Curd Machine ğŸ¥£", goat_cheese_maker: "Goat Cheese Maker ğŸğŸ§€",
  burger_maker: "Burger Maker ğŸ”",
};
 const vyrobkyList = {
  // PÅ¯vodnÃ­ produkty
  kvas_pivo: { nazev: "Beer wort", emoji: "ğŸº" },
  kvas_vino: { nazev: "Wine wort", emoji: "ğŸ§ƒ" },
  most_cider: { nazev: "Apple juice", emoji: "ğŸğŸ§ª" },
  kvas_Å¡vestky: { nazev: "Plum wort", emoji: "ğŸŸ£ğŸ§ª" },
  kvas_jablka: { nazev: "Apple wort", emoji: "ğŸğŸ§ª" },
  kvas_hruÅ¡ky: { nazev: "Pear wort", emoji: "ğŸğŸ§ª" },
  kvas_meruÅˆky: { nazev: "Apricot wort", emoji: "ğŸ‘ğŸ§ª" },
  kvas_broskve: { nazev: "Peach wort", emoji: "ğŸŠğŸ§ª" },
  kvas_kukuÅ™ice: { nazev: "Corn wort", emoji: "ğŸŒ½" },
  kvas_psenice:  { nazev: "Wheat wort", emoji: "ğŸŒ¾" },
  kvas_brambora: { nazev: "Potato wort", emoji: "ğŸ¥”" }, 
  voda: { nazev: "Water", emoji: "ğŸ’§" },
  pivo: { nazev: "Beer", emoji: "ğŸ»" },
  vino: { nazev: "Wine", emoji: "ğŸ·" },
  bacon: { nazev: "Bacon", emoji: "ğŸ¥“" },
  fried_egg: { nazev: "Fried egg", emoji: "ğŸ³" },
  turkey_hamburger: { nazev: "Turkey hamburger", emoji: "ğŸ”" },
  cider: { nazev: "Cider",Â emoji:Â "ğŸ¶"Â },
  popkorn: { nazev: "Popcorn", emoji: "ğŸ¿" },
  hranolky: { nazev: "Fries", emoji: "ğŸŸ" }, 
  testo: { nazev: "Dough", emoji: "ğŸ¥£" },
  bread: { nazev: "Bread", emoji: "ğŸ" },
  curd: { nazev: "Curd", emoji: "ğŸ¥" },
  nudle: { nazev: "Noodles", emoji: "ğŸœ"},
  goat_cheese: { nazev: "Goat cheese", emoji: "ğŸ§€" },
  palenka_Å¡vestky: { nazev: "Slivovitz", emoji: "ğŸŸ£ğŸ¥ƒ" },
  palenka_hruÅ¡ky: { nazev: "Pear Brandy", emoji: "ğŸğŸ¥ƒ" },
  palenka_jablka: { nazev: "CalvÃ¡dos", emoji:Â "ğŸğŸ¥ƒ"Â },
  palenka_meruÅˆky: { nazev: "Apricot Brandy", emoji: "ğŸ‘ğŸ¥ƒ" },
  palenka_broskve: { nazev: "Peach Brandy", emoji: "ğŸŠğŸ¥ƒ" },
  whiskey_kukurice: { nazev: "Whiskey", emoji: "ğŸ¥ƒ" },
  vodka_psenice:    { nazev: "Vodka", emoji: "ğŸ¸" },
  rum_brambora:     { nazev: "Rum", emoji: "ğŸ´â€â˜ ï¸" },
  marmelada_broskve: { nazev: "Peach jam", emoji: "ğŸŠğŸ¯" },
  marmelada_meruÅˆky: { nazev: "Apricot jam", emoji: "ğŸ‘ğŸ¯" },
  marmelada_jahody:  { nazev: "Strawberry jam", emoji: "ğŸ“ğŸ¯" },
  marmelada_tÅ™eÅ¡nÄ›:  { nazev: "Cherry jam", emoji: "ğŸ’ğŸ¯" },
  marmelada_Å¡vestky: { nazev: "Plum jam", emoji: "ğŸŸ£ğŸ¯" },
  marmelada_hruÅ¡ky:  { nazev: "Pear jam", emoji: "ğŸğŸ¯" },
  marmelada_jablko:  { nazev: "Apple jam", emoji: "ğŸğŸ¯" },

  // NovÃ© produkty od zvÃ­Å™at:
  mlÃ©ko: { nazev: "Milk", emoji: "ğŸ¥›" },
  kozÃ­_mlÃ©ko: { nazev: "Goat milk", emoji: "ğŸ¥›" },
  vejce: { nazev: "Egg", emoji: "ğŸ¥š" },
  Å¡unka: { nazev: "Ham", emoji: "ğŸ–" },
  krÅ¯tÃ­_maso: { nazev: "Turkey meat", emoji: "ğŸ—" },
  med: { nazev: "Honey", emoji: "ğŸ¯" },
  vlna: { nazev: "Wool", emoji: "ğŸ§¶" },
  krÃ¡liÄÃ­_maso: { nazev: "Rabbit meat", emoji: "ğŸ¥©" },
  kachnÃ­_vejce: { nazev: "Duck egg", emoji: "ğŸ¥š" },
  shrimp:   { nazev: "Shrimp",emoji: "ğŸ¦" },
  crab:     { nazev: "Crab",emoji: "ğŸ¦€" },
  fish:     { nazev: "Fish",emoji: "ğŸ " },
  octopus:  { nazev: "Octopus",emoji: "ğŸ™" },
  tempura:  { nazev: "Tempura",emoji: "ğŸ¤" },
};
const firebaseConfig = {
    apiKey: "AIzaSyCfPJJL8cbfxmpWpHG5_icQOZjzGWSpeZI",
    authDomain: "drunk-punk.firebaseapp.com",
    projectId: "drunk-punk",
    storageBucket: "drunk-punk.firebasestorage.app",
    messagingSenderId: "749798531604",
    appId: "1:749798531604:web:9e702aee7c9a2599627d01",
    measurementId: "G-JSFRP622EL"
};
if (!firebase.apps.length) {
    firebase.initializeApp(firebaseConfig);
}
const firestore = firebase.firestore();
// Po inicializaci Firebase
firebase.auth().onAuthStateChanged(function(user) {
  if (user) {
    showMsg("Signed as: " + (user.email || user.uid));
    // (MÅ¯Å¾eÅ¡ tu povolit tlaÄÃ­tka/save nebo vykreslit vÃ­c informacÃ­)
  } else {
    // Nezobrazuj nic. KdyÅ¾ chceÅ¡, mÅ¯Å¾eÅ¡ SAVE schovat, ale Å¾Ã¡dnÃ¡ hlÃ¡Å¡ka
    // document.querySelector('.back-disketa').style.display='none';
  }
});

function saveLocalStorageToCloud() {
    var piUser = localStorage.getItem("piUser");
    if (!piUser) {
        if (!window.Pi) {
            showMsg("Pi SDK is not loaded!");
            return;
        }
        Pi.authenticate(["username"], function () { })
            .then(function (auth) {
                if (auth && auth.user && auth.user.username) {
                    localStorage.setItem("piUser", auth.user.username);
                    saveLocalStorageToCloud();
                } else {
                    showMsg("Failed to sign in.");
                }
            })
            .catch(function (err) {
                showMsg("Login error: " + err.message);
            });
        return;
    }

    // 1. StÃ¡hni existujÃ­cÃ­ cloudovou XP historii
    firestore.collection("pi_saves").doc(piUser).get().then(function(doc) {
        var oldXPHistory = [];
        if (doc.exists && doc.data().data && doc.data().data.xpHistory) {
            try {
                oldXPHistory = Array.isArray(doc.data().data.xpHistory)
                    ? doc.data().data.xpHistory
                    : JSON.parse(doc.data().data.xpHistory);
            } catch (e) { oldXPHistory = []; }
        }
        // 2. XP historie z localStorage
        var localXPHistory = [];
        try {
            localXPHistory = JSON.parse(localStorage.getItem("xpHistory") || "[]");
        } catch (e) { localXPHistory = []; }
        // 3. Spoj bez duplicit
        var allXPHistory = oldXPHistory.concat(localXPHistory.filter(function(newItem){
            return !oldXPHistory.some(function(oldItem){
                return oldItem.timestamp === newItem.timestamp && oldItem.xp === newItem.xp;
            });
        }));
        // 4. PÅ™idej aktuÃ¡lnÃ­ XP pokud je novÃ©
        var currentXP = parseInt(localStorage.getItem("lihobaronFarmXP") || "0", 10);
        if (!allXPHistory.length || allXPHistory[allXPHistory.length-1].xp !== currentXP) {
            allXPHistory.push({xp: currentXP, timestamp: Date.now()});
        }
        // 5. UloÅ¾ do localStorage i do dat pro cloud
        localStorage.setItem("xpHistory", JSON.stringify(allXPHistory));
        var data = {};
        for (var i = 0; i < localStorage.length; i++) {
            var key = localStorage.key(i);
            data[key] = localStorage.getItem(key);
        }
        data.xpHistory = allXPHistory;
        data.piUser = piUser;

        // 6. UloÅ¾ do cloudu
        firestore.collection("pi_saves").doc(piUser).set({
            data: data,
            savedAt: new Date().toISOString()
        }).then(function () {
            showMsg("âœ… Game saved!");
        }).catch(function (error) {
            showMsg("Saving error: " + error.message);
        });
    });
}


// --- Suroviny ---
function vypisSuroviny() {
  const sklad = JSON.parse(localStorage.getItem("lihobaronFarmStorage") || "{}");
  let out = "";
  Object.keys(surovinyList).forEach(k => {
    if (sklad[k]) out += `<div class="polozka"><span class="ikona">${surovinyList[k].emoji}</span> ${surovinyList[k].nazev}: <b>${sklad[k]}</b></div>`;
  });
  if (!out) out = `<div class="none">No resources</div>`;
  document.getElementById("suroviny").innerHTML = out;
}
// --- Semena ---
function vypisSemena() {
  const seeds = JSON.parse(localStorage.getItem("lihobaronFarmSeeds") || "{}");
  let out = "";
  Object.keys(semenaList).forEach(k => {
    if (seeds[k]) out += `<div class="polozka"><span class="ikona">${semenaList[k].emoji}</span> ${semenaList[k].nazev}: <b>${seeds[k]}</b></div>`;
  });
  if (!out) out = `<div class="none">No seeds</div>`;
  document.getElementById("semena").innerHTML = out;
}
// --- Stroje ---
function vypisStroje() {
  const machines = JSON.parse(localStorage.getItem("lihobaronMachines") || "[]");
  let out = "";
  Object.keys(strojeList).forEach(k => {
    if (machines.includes(k)) out += `<div class="polozka">${strojeList[k]}</div>`;
  });
  if (!out) out = `<div class="none">No machines</div>`;
  document.getElementById("stroje").innerHTML = out;
}
// --- Kvasy a vÃ½robky ---
function vypisVyrobky() {
  const sklad = JSON.parse(localStorage.getItem("lihobaronFarmStorage") || "{}");
  let out = "";
  Object.keys(vyrobkyList).forEach(k => {
    if (sklad[k]) out += `<div class="polozka"><span class="ikona">${vyrobkyList[k].emoji}</span> ${vyrobkyList[k].nazev}: <b>${sklad[k]}</b></div>`;
  });
  if (!out) out = `<div class="none">No ferments or products</div>`;
  document.getElementById("vyrobky").innerHTML = out;
}


vypisStroje();
vypisSemena();
vypisSuroviny();
vypisVyrobky();
vypisZvirata();
</script>
</body>
</html>
